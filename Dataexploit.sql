-- Create the 6 tables for Strabucks locations
-------- 1
drop table if exists departments;

create table departments(
	dept_no text primary key,
	dept_name text
);

select * from departments;
--------- 2
drop table if exists dept_emp;

create table dept_emp(
	emp_no int,-- primary key,
	dept_no text ,
	from_date date,
	to_date date
);

select * from dept_emp;
--------- 3
drop table if exists dept_manager;

create table dept_manager(
	dept_no text,
	emp_no int, -- primary key,
	from_date date,
	to_date date
);

 --------- 4
drop table if exists employees;

create table employees(
	emp_no int primary key,
	birth_date date,
	first_name text,
	last_name text,
	gender text,
	hire_date date
);

select * from employees;
--------- 5
drop table if exists salaries;

create table salaries(
	emp_no int, -- primary key,
	salary numeric,
	from_date date,
	to_date date
);

select * from salaries;
--------- 6
drop table if exists titles;

create table titles(
	emp_no int, -- primary key,
	title text,
	from_date date,
	to_date date
);

select * from titles;


----------------------------------------------------------------
---- Run Queries

-- 1. List the following details of each employee: employee number,
-- last name, first name, gender, and salary.

drop table if exists query1;

create table query1 as
select a.emp_no, a.last_name, a.first_name, a.gender, b.salary
from employees a
inner join salaries b on a.emp_no=b.emp_no;

select * from query1;

-- 2. List employees who were hired in 1986.

drop table if exists query2;

create table query2 as 
select emp_no, first_name, last_name, hire_date
from employees 
where hire_date >= '1986-01-01' and hire_date <='1986-12-31';

select * from query2;

-- List the manager of each department with the following information: 
-- department number, department name, the manager's employee number, last name, 
-- first name, and start and end employment dates.

drop table if exists query3;

create table query3 as 
select b.dept_no, b.dept_name, c.emp_no, c.last_name, c.first_name, a.from_date, a.to_date
from dept_manager a
inner join departments b on a.dept_no=b.dept_no
inner join employees c on c.emp_no=a.emp_no;

select * from query3;

-- 4. List the department of each employee with the following information: 
-- employee number, last name, first name, and department name.

drop table if exists query4;

create table query4 as 
select a.emp_no, a.last_name, a.first_name, c.dept_name
from employees a 
inner join dept_emp b on a.emp_no=b.emp_no
inner join departments c on b.dept_no=c.dept_no;

select * from query4;

-- 5. List all employees whose first name is "Hercules" and last 
-- names begin with "B."

drop table if exists query5;

create table query5 as 
select a.emp_no, a.first_name, a.last_name
from employees a
where a.first_name = 'Hercules'
and a.last_name like 'B%';

select * from query5;

-- 6. List all employees in the Sales department, including their employee number,
-- last name, first name, and department name.

drop table if exists query6;

create table query6 as
select a.emp_no, a.last_name, a.first_name, c.dept_name
from employees a
inner join dept_emp b on a.emp_no=b.emp_no
inner join departments c on b.dept_no=c.dept_no
where c.dept_name = 'Sales';

select * from query6;

-- 7. List all employees in the Sales and Development departments, 
-- including their employee number, last name, first name, and department name.

drop table if exists query7;

create table query7 as
select a.emp_no, a.last_name, a.first_name, b.dept_name
from employees a
inner join dept_emp c on a.emp_no=c.emp_no
inner join departments b on b.dept_no=c.dept_no
where b.dept_name in ('Sales','Development');

select * from query7;

-- 8. In descending order, list the frequency count of employee last names, 
-- i.e., how many employees share each last name.

drop table if exists query8;

create table query8 as
select a.last_name, count(a.last_name) as employees_count 
from employees a 
group by a.last_name
order by employees_count DESC;

select * from query8;
